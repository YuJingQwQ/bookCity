<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.yt.boot.dao.BookMapper">
    <select id="queryAllBooks" resultMap="myBookResultMap">
        select *
        from t_book
    </select>

    <select id="queryTotalBookNumber" resultType="long">
        select count(*)
        from t_book
    </select>

    <select id="queryBooksByPrice" resultMap="myBookResultMap">
        select * from t_book
        <where>
            price >= #{min} and price <![CDATA[<]]>= #{max}
        </where>
        order by price asc
    </select>

    <select id="queryTotalBookNumberByPrice" resultType="long">
        select count(*) from t_book
        <where>
            price >= #{min} and price <![CDATA[<]]>= #{max}
        </where>
    </select>

    <select id="commonBook" resultMap="myBookResultMap">
        select * from t_book
        <where>
            <if test="id != null and id != ''">and id = #{id}</if>
            <if test="name != null and name != ''">and name = #{name}</if>
            <if test="author != null and author != ''">and author = #{author}</if>
            <if test="price != null and price != ''">and price = #{price}</if>
            <if test="sales != null and sales != ''">and sales = #{sales}</if>
            <if test="stock != null and stock != ''">and stock = #{stock}</if>
        </where>
    </select>

    <update id="update">
        update t_book
        <set>
            name = #{name}, author = #{author}, price = #{price}, sales =#{sales}, stock = #{stock}
        </set>
        <where>
            id = #{id}
        </where>
    </update>

    <delete id="delete">
        delete from t_book
        <where>
            <if test="id != null and id != ''">and id = #{id}</if>
            <if test="name != null and name != ''">and name = #{name}</if>
            <if test="author != null and author != ''">and author = #{author}</if>
            <if test="price != null and price != ''">and price = #{price}</if>
            <if test="sales != null and sales != ''">and sales = #{sales}</if>
            <if test="stock != null and stock != ''">and stock = #{stock}</if>
        </where>
    </delete>
    <insert id="add">
        insert into t_book(name, author, price, sales, stock, img_path)
        values (#{name}, #{author}, #{price}, #{sales}, #{stock}, #{imgPath})
    </insert>

    <resultMap id="myBookResultMap" type="com.yt.boot.pojo.Book">
        <id property="id" column="id"></id>
        <result property="name" column="name"></result>
        <result property="author" column="author"></result>
        <result property="price" column="price"></result>
        <result property="sales" column="sales"></result>
        <result property="stock" column="stock"></result>
        <result property="imgPath" column="img_path"></result>
    </resultMap>
</mapper>